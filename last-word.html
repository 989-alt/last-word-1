<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì¿µì¿µë”° - ì´ˆë“± ëë§ì‡ê¸°</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts (Jua for kid-friendly look) -->
    <link href="https://fonts.googleapis.com/css2?family=Jua&display=swap" rel="stylesheet">

    <!-- Animate.css for fun effects -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css"/>

    <style>
        body {
            font-family: 'Jua', sans-serif;
            background-color: #F0F9FF; /* Soft Cloud Blue */
        }
        .chat-bubble {
            max-width: 80%;
            padding: 10px 15px;
            border-radius: 20px;
            margin-bottom: 10px;
            position: relative;
            font-size: 1.2rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        .ai-bubble {
            background-color: #ffffff;
            color: #4B5563;
            border-top-left-radius: 0;
            margin-right: auto;
            border: 2px solid #E5E7EB;
        }
        .user-bubble {
            background-color: #FFDEE9;
            background-image: linear-gradient(0deg, #FFDEE9 0%, #B5FFFC 100%);
            color: #1F2937;
            border-top-right-radius: 0;
            margin-left: auto;
            text-align: right;
        }
        .system-bubble {
            background-color: #FEF3C7;
            color: #D97706;
            text-align: center;
            font-size: 1rem;
            margin: 0 auto 10px auto;
            border-radius: 10px;
            width: fit-content;
        }
        
        /* Custom Scrollbar */
        #chat-history::-webkit-scrollbar {
            width: 8px;
        }
        #chat-history::-webkit-scrollbar-track {
            background: #f1f1f1; 
            border-radius: 4px;
        }
        #chat-history::-webkit-scrollbar-thumb {
            background: #93C5FD; 
            border-radius: 4px;
        }
        #chat-history::-webkit-scrollbar-thumb:hover {
            background: #60A5FA; 
        }

        .timer-bar {
            transition: width 1s linear;
        }
    </style>
</head>
<body class="h-screen flex flex-col items-center justify-center p-4">

    <!-- Game Container -->
    <div class="w-full max-w-md bg-white rounded-3xl shadow-2xl overflow-hidden border-4 border-blue-200 flex flex-col h-[90vh]">
        
        <!-- Header -->
        <div class="bg-blue-400 p-4 text-center relative">
            <h1 class="text-3xl text-white drop-shadow-md">ğŸˆ AI ì¿µì¿µë”° ğŸˆ</h1>
            <p class="text-blue-100 text-sm mt-1">ë‘ìŒë²•ì¹™ ì ìš© | ì œí•œì‹œê°„ 30ì´ˆ</p>
            <button onclick="resetGame()" class="absolute right-3 top-3 bg-white text-blue-500 rounded-full p-2 hover:bg-blue-50 transition shadow-md" title="ë‹¤ì‹œ ì‹œì‘">
                <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2.5" stroke="currentColor" class="w-5 h-5">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0l3.181 3.183a8.25 8.25 0 0013.803-3.7M4.031 9.865a8.25 8.25 0 0113.803-3.7l3.181 3.182m0-4.991v4.99" />
                </svg>
            </button>
        </div>

        <!-- Timer Section -->
        <div class="bg-gray-100 h-2 w-full">
            <div id="timer-bar" class="h-full bg-green-400 w-full timer-bar"></div>
        </div>
        <div class="text-center py-1 bg-gray-50 text-gray-500 text-sm font-bold">
            ë‚¨ì€ ì‹œê°„: <span id="timer-text" class="text-blue-500 text-lg">30</span>ì´ˆ
        </div>

        <!-- Chat History (Game Board) -->
        <div id="chat-history" class="flex-1 overflow-y-auto p-4 space-y-3 bg-white">
            <!-- Messages will be injected here -->
        </div>

        <!-- Input Area -->
        <div class="p-4 bg-blue-50 border-t border-blue-100">
            <div class="flex gap-2">
                <input type="text" id="user-input" 
                    class="flex-1 border-2 border-blue-300 rounded-xl px-4 py-3 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 text-lg transition"
                    placeholder="ë‹¨ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”!" autocomplete="off">
                <button onclick="submitWord()" 
                    class="bg-blue-500 hover:bg-blue-600 text-white rounded-xl px-6 font-bold shadow-lg transform active:scale-95 transition">
                    ì…ë ¥
                </button>
            </div>
            <div id="feedback-msg" class="text-center text-red-500 mt-2 h-5 text-sm font-bold"></div>
        </div>
    </div>

    <!-- Modal for Game Over -->
    <div id="game-over-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center hidden z-50">
        <div class="bg-white rounded-3xl p-8 max-w-sm w-full text-center shadow-2xl animate__animated animate__bounceIn">
            <div class="text-6xl mb-4" id="modal-emoji">ğŸ†</div>
            <h2 class="text-3xl text-gray-800 mb-2" id="modal-title">ê²Œì„ ì¢…ë£Œ!</h2>
            <p class="text-gray-600 mb-6 text-lg" id="modal-message">ê²°ê³¼ ë©”ì‹œì§€ê°€ ì—¬ê¸°ì— ëœ¹ë‹ˆë‹¤.</p>
            <button onclick="resetGame()" class="w-full bg-blue-500 text-white py-3 rounded-xl text-xl hover:bg-blue-600 shadow-lg transition">
                ë‹¤ì‹œ í•˜ê¸°
            </button>
        </div>
    </div>

    <script>
        // --- Data: 500+ Elementary Level Nouns ---
        // ì••ì¶•ì„ ìœ„í•´ ì¼ë¶€ë§Œ ë‚˜ì—´í•˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” ë” ë°©ëŒ€í•˜ê²Œ êµ¬ì„± ê°€ëŠ¥í•©ë‹ˆë‹¤.
        const wordDB = [
            "ê°€ê²Œ", "ê°€ê²©", "ê°€êµ¬", "ê°€ìˆ˜", "ê°€ìŠ´", "ê°€ìœ„", "ê°€ì„", "ê°€ì¡±", "ê°€ì§€", "ê°„ì‹",
            "ê°ˆë¹„", "ê°ê¸°", "ê°ë™", "ê°ì", "ê°•ì•„ì§€", "ê°•ì", "ê°œêµ¬ë¦¬", "ê°œë¯¸", "ê±°ë¯¸", "ê±°ìš¸",
            "ê±°ì§“ë§", "ê±´ê°•", "ê±´ë¬¼", "ê±¸ìŒ", "ê²€ì •", "ê²Œì„", "ê²¨ìš¸", "ê²°ê³¼", "ê²°í˜¼", "ê²½ì°°",
            "ê²½ì¹˜", "ê²½í—˜", "ê³„ë‹¨", "ê³„ë€", "ê³„ì‚°", "ê³„ì ˆ", "ê³„íš", "ê³ ê¸°", "ê³ ëª¨", "ê³ ì–‘ì´",
            "ê³ ì¶”", "ê³ í–¥", "ê³¨ëª©", "ê³°", "ê³µ", "ê³µë¶€", "ê³µì›", "ê³µì¥", "ê³µì±…", "ê³µí•­",
            "ê³¼ì", "ê³¼í•™", "ê´€ì‹¬", "ê´‘ê³ ", "ê´‘ì¥", "êµì‹¤", "êµìœ¡", "êµí†µ", "êµ¬ë¦„", "êµ¬ë©",
            "êµ¬ë‘", "êµ­ê¸°", "êµ­ë¬¼", "êµ­ìˆ˜", "êµ­ì–´", "êµ­ì œ", "êµ°ì¸", "êµ´", "ê·€", "ê·œì¹™",
            "ê·¤", "ê·¸ë„¤", "ê·¸ë¦¼", "ê·¸ë¦¼ì", "ê·¹ì¥", "ê¸€ì", "ê¸ˆ", "ê¸°ê°„", "ê¸°ë¶„", "ê¸°ì°¨",
            "ê¸°íƒ€", "ê¸°íšŒ", "ê¸¸", "ê¹€", "ê¹€ì¹˜", "ê¹ƒë°œ", "ê¹Œì¹˜", "ê½ƒ", "ê½ƒë³‘", "ê½ƒì§‘",
            "ê¿ˆ", "ë‚˜ë¼", "ë‚˜ë¬´", "ë‚˜ë¹„", "ë‚˜ì´", "ë‚šì‹œ", "ë‚ ì”¨", "ë‚ ì§œ", "ë‚¨ë™ìƒ", "ë‚¨ì",
            "ë‚¨ìª½", "ë‚´ìš©", "ëƒ‰ì¥ê³ ", "ë„ˆêµ¬ë¦¬", "ë„¥íƒ€ì´", "ë…¸ë˜", "ë…¸ì¸", "ë…¹ìƒ‰", "ë†€ì´", "ë†êµ¬",
            "ë†ë¶€", "ëˆˆ", "ëˆˆë¬¼", "ë‰´ìŠ¤", "ëŠë‚Œ", "ëŠ‘ëŒ€", "ëŠ¥ë ¥", "ë‹¤ëŒì¥", "ë‹¤ë¦¬", "ë‹¤ìŒ",
            "ë‹¨ì–´", "ë‹¨ì¶”", "ë‹¬", "ë‹¬ê±€", "ë‹¬ë ¥", "ë‹¬ë¦¬ê¸°", "ë‹­", "ë‹´ë°°", "ë‹µ", "ë‹¹ê·¼",
            "ëŒ€ë¬¸", "ëŒ€ì¥", "ëŒ€í™”", "ëŒ€íšŒ", "ë„êµ¬", "ë„ë‘‘", "ë„ì„œê´€", "ë„ì‹œ", "ë„ì›€", "ë„ì°©",
            "ë…ì„œ", "ëˆ", "ëŒ", "ë™ê·¸ë¼ë¯¸", "ë™ë„¤", "ë™ë¬¼", "ë™ë¬¼ì›", "ë™ìƒ", "ë™ì „", "ë™í™”",
            "ë‘ë¶€", "ë’¤", "ë“œë¼ë§ˆ", "ë“±", "ë“±ì‚°", "ë”¸", "ë”¸ê¸°", "ë•…", "ë–¡", "ë–¡ë³¶ì´",
            "ë¼ë””ì˜¤", "ë¼ë©´", "ë¼ì´í„°", "ë¼ì¼ë½", "ë¡œë´‡", "ë¡œì¼“", "ë¦¬ë³¸", "ë¦¬ë“¬", 
            "ë§ˆì„", "ë§ˆìŒ", "ë§ˆì§€ë§‰", "ë§ˆíŠ¸", "ë§Œë‘", "ë§", "ë§›", "ë§ì›ê²½", "ë§¤ë¯¸", "ë¨¸ë¦¬",
            "ë¨¹ì´", "ë¨¼ì§€", "ë©”ëª¨", "ë©”ì•„ë¦¬", "ë©°ëŠë¦¬", "ëª…ì ˆ", "ëª¨ê¸°", "ëª¨ë˜", "ëª¨ìŠµ", "ëª¨ì–‘",
            "ëª¨ì", "ëª©", "ëª©ê±¸ì´", "ëª©ì†Œë¦¬", "ëª©ìš”ì¼", "ëª©ìš•", "ëª©í‘œ", "ëª¸", "ëª»", "ë¬´",
            "ë¬´ê¶í™”", "ë¬´ëŠ¬", "ë¬´ë¦", "ë¬´ì§€ê°œ", "ë¬¸", "ë¬¸í™”", "ë¬¼", "ë¬¼ê±´", "ë¬¼ê³ ê¸°", "ë¬¼ìŒí‘œ",
            "ë¯¸êµ­", "ë¯¸ë˜", "ë¯¸ì†Œ", "ë¯¸ìˆ ", "ë¯¸ì—­", "ë¯¿ìŒ", "ë°”ë‚˜ë‚˜", "ë°”ë‹¤", "ë°”ë‹¥", "ë°”ëŒ",
            "ë°”ë³´", "ë°”ì§€", "ë°•ìˆ˜", "ë°–", "ë°˜", "ë°˜ì§€", "ë°˜ì°¬", "ë°œ", "ë°œê°€ë½", "ë°œí‘œ",
            "ë°¤", "ë°¥", "ë°©", "ë°©ì†¡", "ë°©í•™", "ë°°", "ë°°êµ¬", "ë°°ì¶”", "ë°±í™”ì ", "ë±€",
            "ë²„ì„¯", "ë²„ìŠ¤", "ë²ˆí˜¸", "ë²Œ", "ë²Œë ˆ", "ë²”ì¸", "ë²•", "ë²šê½ƒ", "ë² ê°œ", "ë²½",
            "ë³€í˜¸ì‚¬", "ë³„", "ë³‘", "ë³‘ì›", "ë³´ì„", "ë³´ë¬¼", "ë³µìˆ­ì•„", "ë³¶ìŒë°¥", "ë³¼íœ", "ë´„",
            "ë´‰íˆ¬", "ë¶€ëª¨", "ë¶€ì—Œ", "ë¶€ì±„", "ë¶", "ë¶ìª½", "ë¶„í•„", "ë¶ˆ", "ë¶ˆê³ ê¸°", "ë¶•ì–´ë¹µ",
            "ë¹„", "ë¹„ëˆ„", "ë¹„ë””ì˜¤", "ë¹„ë°€", "ë¹„í–‰ê¸°", "ë¹—", "ë¹µ", "ì‚¬ê³¼", "ì‚¬ëŒ", "ì‚¬ë‘",
            "ì‚¬ë¬´ì‹¤", "ì‚¬ìŠ´", "ì‚¬ì‹¤", "ì‚¬ì—…", "ì‚¬ìš©", "ì‚¬ì¥", "ì‚¬ì „", "ì‚¬ì§„", "ì‚¬íƒ•", "ì‚¬íšŒ",
            "ì‚°", "ì‚°ì±…", "ì‚´", "ì‚¼ì´Œ", "ìƒ", "ìƒì", "ìƒì²˜", "ìƒí’ˆ", "ìƒˆ", "ìƒˆìš°",
            "ìƒ‰", "ìƒ‰ì—°í•„", "ìƒê°", "ìƒì„ ", "ìƒì¼", "ìƒí™œ", "ìƒ¤ì›Œ", "ì„œì ", "ì„ ë¬¼", "ì„ ìƒë‹˜",
            "ì„ ìˆ˜", "ì„ í’ê¸°", "ì„¤ë‚ ", "ì„¤íƒ•", "ì„¬", "ì„±ê²©", "ì„±ê³µ", "ì„±ì ", "ì„¸ê³„", "ì„¸ìˆ˜",
            "ì„¸ìƒ", "ì„¼í„°", "ì†Œ", "ì†Œê¸ˆ", "ì†Œë‚˜ê¸°", "ì†Œë…€", "ì†Œë…„", "ì†Œë¦¬", "ì†Œë°©ê´€", "ì†Œì„¤",
            "ì†Œì‹", "ì†Œí’", "ì†", "ì†ê°€ë½", "ì†ìˆ˜ê±´", "ì†œ", "ì†¡í¸", "ìˆ˜ê±´", "ìˆ˜ë°•", "ìˆ˜ìˆ ",
            "ìˆ˜ì—…", "ìˆ˜ì˜", "ìˆ˜ìš”ì¼", "ìˆ˜ì²©", "ìˆ˜í•™", "ìˆ™ì œ", "ìˆœì„œ", "ìˆŸê°€ë½", "ìˆ ", "ìˆ²",
            "ìŠˆí¼ë§ˆì¼“", "ìŠ¤ì›¨í„°", "ìŠ¤ì¼€ì´íŠ¸", "ìŠ¤í‚¤", "ìŠ¤íƒ€", "ìŠ¤íŠ¸ë ˆìŠ¤", "ìŠ¬í””", "ìŠµê´€", "ìŠ¹ë¦¬", "ì‹œ",
            "ì‹œê°„", "ì‹œê³„", "ì‹œê³¨", "ì‹œì¥", "ì‹œì‘", "ì‹œí—˜", "ì‹êµ¬", "ì‹ë‹¹", "ì‹ë¬¼", "ì‹ì‚¬",
            "ì‹íƒ", "ì‹ ", "ì‹ ë¬¸", "ì‹ ë°œ", "ì‹ í˜¸ë“±", "ì‹¤", "ì‹¤ë‚´", "ì‹¤ìˆ˜", "ì‹¤íŒ¨", "ì‹¬ì¥",
            "ì‹­ì¼ì›”", "ì“°ë ˆê¸°", "ì”¨", "ì”¨ì•—", "ì•„ê¸°", "ì•„ë‚´", "ì•„ë“¤", "ì•„ì´ìŠ¤í¬ë¦¼", "ì•„ì¹¨", "ì•„íŒŒíŠ¸",
            "ì•„í””", "ì•…ê¸°", "ì•…ì–´", "ì•ˆ", "ì•ˆê²½", "ì•ˆê°œ", "ì•ˆë…•", "ì•ˆì „", "ì•", "ì•½",
            "ì•½êµ­", "ì•½ì†", "ì–‘", "ì–‘ë§", "ì–‘ë³µ", "ì–‘ì¹˜", "ì–´ê¹¨", "ì–´ë¨¸ë‹ˆ", "ì–´ë¥¸", "ì–´ë¦°ì´",
            "ì–´í•­", "ì–¼êµ´", "ì–¼ìŒ", "ì—„ë§ˆ", "ì—‰ë©ì´", "ì—ì–´ì»¨", "ì—˜ë¦¬ë² ì´í„°", "ì—¬ê¶Œ", "ì—¬ê¸°", "ì—¬ë™ìƒ",
            "ì—¬ë¦„", "ì—¬ìš°", "ì—¬ì", "ì—¬í–‰", "ì—­", "ì—­ì‚¬", "ì—°ê²°", "ì—°ê¸°", "ì—°ë‘ìƒ‰", "ì—°ë½",
            "ì—°ë§", "ì—°ìŠµ", "ì—°ì˜ˆì¸", "ì—°í•„", "ì—°íœ´", "ì—´", "ì—´ë§¤", "ì—´ì‡ ", "ì—½ì„œ", "ì˜êµ­",
            "ì˜ìƒ", "ì˜ì–´", "ì˜í™”", "ì˜†", "ì˜ˆìŠµ", "ì˜ˆìˆ ", "ì˜ˆì ˆ", "ì˜›ë‚ ", "ì˜¤ëŠ˜", "ì˜¤ë¹ ",
            "ì˜¤ì´", "ì˜¤ì „", "ì˜¤ì§•ì–´", "ì˜¤í›„", "ì˜¨ë„", "ì˜¬í•´", "ì˜·", "ì˜·ì¥", "ì™•", "ì™•ì",
            "ì™¸êµ­", "ì™¸êµ­ì¸", "ì™¼ìª½", "ìš”ë¦¬", "ìš”ë¦¬ì‚¬", "ìš”ì¼", "ìš”ì¦˜", "ìš•ì‹¤", "ìš©ëˆ", "ìš©ê¸°",
            "ìš°ì‚°", "ìš°ìœ ", "ìš°ì •", "ìš°í‘œ", "ìš´ë™", "ìš´ë™ì¥", "ìš´ë™í™”", "ìš¸ìŒ", "ìŒë£Œìˆ˜", "ìŒì‹",
            "ìŒì•…", "ì˜ë¯¸", "ì˜ì‚¬", "ì˜ì", "ì´", "ì´ë¦„", "ì´ëª¨", "ì´ë¶ˆ", "ì´ì‚¬", "ì´ì•¼ê¸°",
            "ì´ìœ ", "ì´ì›ƒ", "ì¸ê¸°", "ì¸ì‚¬", "ì¸ìƒ", "ì¸í˜•", "ì¼", "ì¼ê¸°", "ì¼ë³¸", "ì¼ìš”ì¼",
            "ì¼ì£¼ì¼", "ì…", "ì…êµ¬", "ì…ìˆ ", "ì", "ìë™ì°¨", "ìë¦¬", "ìì „ê±°", "ìì£¼ìƒ‰", "ììœ ",
            "ì‘ë…„", "ì‘ì€ì•„ë²„ì§€", "ì”", "ì”ë””", "ì ", "ì ìë¦¬", "ì¥ê°‘", "ì¥ë‚œê°", "ì¥ë¯¸", "ì¥ì†Œ",
            "ì €ë…", "ì €ê¸ˆí†µ", "ì €ë¶„", "ì „", "ì „ê³µ", "ì „ê¸°", "ì „ì", "ì „í†µ", "ì „í™”", "ì ì‹¬",
            "ì ìˆ˜", "ì ‘ì‹œ", "ì “ê°€ë½", "ì •ë¦¬", "ì •ë§", "ì •ë¬¸", "ì •ë³´", "ì •ì›", "ì •ì¹˜", "ì œëª©",
            "ì œì£¼ë„", "ì¡¸ì—…", "ì¢€", "ì¢…", "ì¢…ë¥˜", "ì¢…ì´", "ì£¼", "ì£¼ë§", "ì£¼ë¨¸ë‹ˆ", "ì£¼ë¯¼",
            "ì£¼ì‚¬", "ì£¼ì†Œ", "ì£¼ìŠ¤", "ì£¼ì¸", "ì£¼ì°¨ì¥", "ì£¼í™©ìƒ‰", "ì¤€ë¹„", "ì¤„", "ì¤‘êµ­", "ì¤‘ì‹¬",
            "ì¤‘ì•™", "ì¤‘í•™êµ", "ì¥", "ì§€ê°‘", "ì§€ê¸ˆ", "ì§€ë‚œë‹¬", "ì§€ìš°ê°œ", "ì§€í•˜", "ì§€í•˜ì² ", "ì§ì—…",
            "ì§ì¥", "ì§ˆë¬¸", "ì§‘", "ì§œì¥ë©´", "ìª½", "ì°¨", "ì°½ë¬¸", "ì±„ì†Œ", "ì±…", "ì±…ìƒ",
            "ì±…ì¥", "ì²˜ìŒ", "ì²œ", "ì²œì¥", "ì² ", "ì²«ì§¸", "ì²­ì†Œ", "ì²´ìœ¡", "ì´ˆ", "ì´ˆëŒ€",
            "ì´ˆë¡ìƒ‰", "ì´ˆë“±í•™êµ", "ì´ˆì½œë¦¿", "ìµœê³ ", "ì¶”ì„", "ì¶”ì–µ", "ì¶•êµ¬", "ì¶•ì œ", "ì¶œêµ¬", "ì¶œë°œ",
            "ì¶¤", "ì·¨ë¯¸", "ì¸µ", "ì¹˜ê³¼", "ì¹˜ë§ˆ", "ì¹œêµ¬", "ì¹¨ëŒ€", "ì¹«ì†”", "ì¹´ë©”ë¼", "ì¹´í˜",
            "ì¹¼", "ì»¤í”¼", "ì»´í“¨í„°", "ì»µ", "ì¼€ì´í¬", "ì½”", "ì½”ë¼ë¦¬", "ì½”íŠ¸", "ì½œë¼", "ì½©",
            "í¬ê¸°", "í¬ë¦¬ìŠ¤ë§ˆìŠ¤", "í‚¤", "íƒì‹œ", "í„±", "í„¸", "í…Œë‹ˆìŠ¤", "í…Œì´ë¸”", "í…”ë ˆë¹„ì „", "í† ë¼",
            "í† ë§ˆí† ", "í† ìš”ì¼", "í†µì¥", "íŠ¸ëŸ­", "íŠ¹ê¸°", "í‹°ì…”ì¸ ", "íŒ€", "íŒŒ", "íŒŒë€ìƒ‰", "íŒŒí‹°",
            "íŒ”", "í¸ì§€", "í¬ë„", "í¬í¬", "í‘œ", "í‘œì •", "í’€", "í’ì„ ", "í”¼", "í”¼êµ¬",
            "í”¼ë…¸í‚¤ì˜¤", "í”¼ë§", "í”¼ë¶€", "í”¼ì•„ë…¸", "í”¼ì", "í•„í†µ", "í•˜ë‚˜ë‹˜", "í•˜ëŠ˜", "í•˜ë£¨", "í•˜ë§ˆ",
            "í•™êµ", "í•™ë…„", "í•™ìƒ", "í•™ì›", "í•œ", "í•œêµ­", "í•œê¸€", "í•œë³µ", "í• ë¨¸ë‹ˆ", "í• ì•„ë²„ì§€",
            "í•¨", "í•©ê²©", "í•´", "í•´ë¬¼", "í•¸ë“œí°", "í–„ë²„ê±°", "í–‰ë™", "í–‰ë³µ", "í–‰ì‚¬", "í—ˆë¦¬",
            "í˜„ê¸ˆ", "í˜•", "í˜•ì œ", "í˜¸ë‘ì´", "í˜¸ìˆ˜", "í˜¸ì£¼ë¨¸ë‹ˆ", "í˜¸í…”", "í˜¼ì", "í™ì‹œ", "í™”",
            "í™”ê°€", "í™”ì¥ì‹¤", "í™”ìš”ì¼", "í™•ì¸", "í™˜ê²½", "í™˜ì", "íšŒì‚¬", "íšŒì˜", "íš¡ë‹¨ë³´ë„", "íš¨ë„",
            "í›„", "í›„ë°°", "íœ´ê°€", "íœ´ëŒ€ì „í™”", "íœ´ì§€", "íœ´ì¼", "í‰ë‚´", "íë¦„", "í”ì ", "í¬ë§",
            "í°ìƒ‰", "í˜"
        ];
        
        // Dueum Beopchik Map (ë‘ìŒë²•ì¹™ ë³€í™˜ í…Œì´ë¸”)
        const dueumMap = {
            'ë¼': 'ë‚˜', 'ë½': 'ë‚™', 'ë€': 'ë‚œ', 'ë„': 'ë‚ ', 'ëŒ': 'ë‚¨', 'ë': 'ë‚©', 'ë‘': 'ë‚­',
            'ë˜': 'ë‚´', 'ë­': 'ëƒ‰', 'ëƒ‘': 'ì•½', 'ëµ': 'ì•½', 'ëƒ¥': 'ì–‘', 'ëŸ‰': 'ì–‘', 'ë…€': 'ì—¬',
            'ë ¤': 'ì—¬', 'ë…': 'ì—­', 'ë ¥': 'ì—­', 'ë…„': 'ì—°', 'ë ¨': 'ì—°', 'ë…ˆ': 'ì—´', 'ë ¬': 'ì—´',
            'ë…': 'ì—¼', 'ë ´': 'ì—¼', 'ë µ': 'ì—½', 'ë…•': 'ì˜', 'ë ¹': 'ì˜', 'ë…œ': 'ì˜ˆ', 'ë¡€': 'ì˜ˆ',
            'ë¡œ': 'ë…¸', 'ë¡': 'ë…¹', 'ë¡ ': 'ë…¼', 'ë¡±': 'ë†', 'ë¢°': 'ë‡Œ', 'ë‡¨': 'ìš”', 'ë£Œ': 'ìš”',
            'ë£¡': 'ìš©', 'ë£¨': 'ëˆ„', 'ë‰´': 'ìœ ', 'ë¥˜': 'ìœ ', 'ë‰µ': 'ìœ¡', 'ë¥™': 'ìœ¡', 'ë¥œ': 'ìœ¤',
            'ë¥ ': 'ìœ¨', 'ë¥­': 'ìœµ', 'ë¥´': 'ëŠ', 'ë¥µ': 'ëŠ‘', 'ë¦„': 'ëŠ ', 'ë¦‰': 'ëŠ¥', 'ë‹ˆ': 'ì´',
            'ë¦¬': 'ì´', 'ë¦°': 'ì¸', 'ë¦¼': 'ì„', 'ë¦½': 'ì…'
        };

        // Game State
        let usedWords = new Set();
        let currentWord = "";
        let timeLeft = 30;
        let timerInterval;
        let isGameRunning = false;
        let aiWords = [...wordDB]; // Copy for AI usage

        // DOM Elements
        const chatHistory = document.getElementById('chat-history');
        const userInput = document.getElementById('user-input');
        const timerText = document.getElementById('timer-text');
        const timerBar = document.getElementById('timer-bar');
        const feedbackMsg = document.getElementById('feedback-msg');

        // Modal Elements
        const modal = document.getElementById('game-over-modal');
        const modalEmoji = document.getElementById('modal-emoji');
        const modalTitle = document.getElementById('modal-title');
        const modalMessage = document.getElementById('modal-message');

        // Sounds (Using browser synthesis for simplicity)
        const speak = (text) => {
            const utterance = new SpeechSynthesisUtterance(text);
            utterance.lang = 'ko-KR';
            utterance.rate = 1.0;
            window.speechSynthesis.speak(utterance);
        };

        // --- Functions ---

        function initGame() {
            // Reset State
            usedWords.clear();
            aiWords = [...wordDB];
            chatHistory.innerHTML = '';
            userInput.value = '';
            feedbackMsg.innerText = '';
            timeLeft = 30;
            isGameRunning = true;
            
            // UI Reset
            modal.classList.add('hidden');
            timerText.innerText = "30";
            timerBar.style.width = "100%";
            timerBar.classList.remove('bg-red-500');
            timerBar.classList.add('bg-green-400');
            
            // Start Message
            addMessage("system", "ê²Œì„ì„ ì‹œì‘í•©ë‹ˆë‹¤! ì²« ë‹¨ì–´ëŠ” 'ì‚¬ê³¼' ì…ë‹ˆë‹¤.");
            currentWord = "ì‚¬ê³¼";
            usedWords.add("ì‚¬ê³¼");
            addMessage("ai", "ì‚¬ê³¼");
            
            startTimer();
            userInput.focus();
        }

        function startTimer() {
            clearInterval(timerInterval);
            timeLeft = 30;
            updateTimerUI();
            
            timerInterval = setInterval(() => {
                timeLeft--;
                updateTimerUI();
                
                if (timeLeft <= 0) {
                    gameOver(false, "ì‹œê°„ ì´ˆê³¼! ìƒê°í•  ì‹œê°„ì´ ë„ˆë¬´ ì˜¤ë˜ ê±¸ë ¸ì–´ìš” ğŸ˜¢");
                }
            }, 1000);
        }

        function updateTimerUI() {
            timerText.innerText = timeLeft;
            const percentage = (timeLeft / 30) * 100;
            timerBar.style.width = `${percentage}%`;
            
            if (timeLeft <= 10) {
                timerBar.classList.remove('bg-green-400');
                timerBar.classList.add('bg-red-500');
            } else {
                timerBar.classList.add('bg-green-400');
                timerBar.classList.remove('bg-red-500');
            }
        }

        function addMessage(type, text) {
            const div = document.createElement('div');
            
            if (type === 'system') {
                div.className = 'system-bubble';
            } else if (type === 'ai') {
                div.className = 'chat-bubble ai-bubble animate__animated animate__fadeInLeft';
                div.innerHTML = `ğŸ¤– <b>AI:</b> ${text}`;
            } else {
                div.className = 'chat-bubble user-bubble animate__animated animate__fadeInRight';
                div.innerHTML = `<b>ë‚˜:</b> ${text}`;
            }
            
            if (type === 'system') div.innerText = text;
            
            chatHistory.appendChild(div);
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        function checkInput() {
            feedbackMsg.innerText = "";
            const inputWord = userInput.value.trim();
            
            // 1. Validation: Length
            if (inputWord.length < 2) {
                showError("ë‘ ê¸€ì ì´ìƒì˜ ë‹¨ì–´ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”!");
                return false;
            }

            // 2. Validation: Duplication
            if (usedWords.has(inputWord)) {
                showError("ì´ë¯¸ ë‚˜ì˜¨ ë‹¨ì–´ì˜ˆìš”!");
                return false;
            }

            // 3. Validation: Connection & Dueum Beopchik
            const lastChar = currentWord[currentWord.length - 1];
            const firstChar = inputWord[0];
            
            let isValidConnection = false;
            
            // Direct match
            if (lastChar === firstChar) {
                isValidConnection = true;
            } 
            // Dueum Beopchik match
            else if (dueumMap[lastChar] && dueumMap[lastChar] === firstChar) {
                isValidConnection = true;
            }

            if (!isValidConnection) {
                let hint = dueumMap[lastChar] ? `'${lastChar}' ë˜ëŠ” '${dueumMap[lastChar]}'` : `'${lastChar}'`;
                showError(`'${hint}'(ìœ¼)ë¡œ ì‹œì‘í•˜ëŠ” ë‹¨ì–´ì•¼ í•´ìš”!`);
                return false;
            }

            return true;
        }

        function showError(msg) {
            feedbackMsg.innerText = msg;
            userInput.classList.add('animate__animated', 'animate__shakeX', 'border-red-500');
            setTimeout(() => {
                userInput.classList.remove('animate__animated', 'animate__shakeX', 'border-red-500');
            }, 1000);
        }

        function submitWord() {
            if (!isGameRunning) return;

            const inputWord = userInput.value.trim();
            if (checkInput()) {
                // Success
                clearInterval(timerInterval); // Stop timer while processing
                usedWords.add(inputWord);
                currentWord = inputWord;
                addMessage("user", inputWord);
                userInput.value = '';
                
                // AI Turn
                setTimeout(aiTurn, 800);
            }
        }

        function aiTurn() {
            const lastChar = currentWord[currentWord.length - 1];
            
            // Filter candidates
            const candidates = aiWords.filter(word => {
                if (usedWords.has(word)) return false;
                
                const firstChar = word[0];
                // Check direct match OR dueum beopchik match
                if (firstChar === lastChar) return true;
                if (dueumMap[lastChar] && firstChar === dueumMap[lastChar]) return true;
                
                return false;
            });

            if (candidates.length > 0) {
                // AI picks a random word
                const choice = candidates[Math.floor(Math.random() * candidates.length)];
                currentWord = choice;
                usedWords.add(choice);
                addMessage("ai", choice);
                speak(choice); // AI reads the word
                startTimer(); // Restart timer for player
            } else {
                // AI cannot reply
                gameOver(true, `AIê°€ '${lastChar}'(ìœ¼)ë¡œ ì‹œì‘í•˜ëŠ” ë‹¨ì–´ë¥¼ ëª» ì°¾ì•˜ì–´ìš”!`);
            }
        }

        function gameOver(isWin, message) {
            isGameRunning = false;
            clearInterval(timerInterval);
            
            modal.classList.remove('hidden');
            if (isWin) {
                modalEmoji.innerText = "ğŸ†";
                modalTitle.innerText = "ìŠ¹ë¦¬!";
                modalTitle.className = "text-3xl text-blue-600 mb-2 font-bold";
                // confetti effect could go here
            } else {
                modalEmoji.innerText = "ğŸ˜¢";
                modalTitle.innerText = "íŒ¨ë°°...";
                modalTitle.className = "text-3xl text-gray-800 mb-2 font-bold";
            }
            modalMessage.innerText = message;
        }

        function resetGame() {
            initGame();
        }

        // Event Listeners
        userInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !e.isComposing) {
                submitWord();
            }
        });

        // Initialize on load
        window.onload = initGame;

    </script>
</body>
</html>